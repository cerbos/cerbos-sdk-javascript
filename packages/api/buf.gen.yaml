version: v2

clean: true

inputs:
  - directory: proto
    types:
      - cerbos.cloud.epdp.v1.Metadata
      - cerbos.cloud.epdp.v2.BundleService
      - cerbos.cloud.epdp.v2.CheckResourcesResponse
      - cerbos.cloud.epdp.v2.Config
      - cerbos.cloud.epdp.v2.Error
      - cerbos.cloud.epdp.v2.Metadata
      - cerbos.cloud.epdp.v2.PlanResourcesResponse
      - cerbos.response.v1.DeletePolicyErrorDetails
      - cerbos.response.v1.DisablePolicyErrorDetails
      - cerbos.svc.v1.CerbosAdminService
      - cerbos.svc.v1.CerbosService
      - google.rpc.Status
      - grpc.health.v1.Health

plugins:
  - local: node_modules/.bin/protoc-gen-es
    out: packages/api/src/protobuf
    opt:
      - elide_plugin_version=true
      - import_extension=js
      - json_types=true
      - target=ts
      - valid_types=protovalidate_required
